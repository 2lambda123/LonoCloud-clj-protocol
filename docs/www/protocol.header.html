<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>protocol.header documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-protocol</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="tutorial.html"><div class="inner"><span>Quick Tutorial</span></div></a></li><li class="depth-1 "><a href="examples.html"><div class="inner"><span>Example programs</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dhcp</span></div></div></li><li class="depth-2 branch"><a href="dhcp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="dhcp.json-pool-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>json-pool-server</span></div></a></li><li class="depth-2 branch"><a href="dhcp.node-client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node-client</span></div></a></li><li class="depth-2 branch"><a href="dhcp.node-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node-server</span></div></a></li><li class="depth-2"><a href="dhcp.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>icmp</span></div></div></li><li class="depth-2 branch"><a href="icmp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="icmp.ping.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ping</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>pcap</span></div></div></li><li class="depth-2 branch"><a href="pcap.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="pcap.nbb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nbb</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>protocol</span></div></div></li><li class="depth-2 branch"><a href="protocol.addrs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>addrs</span></div></a></li><li class="depth-2 branch"><a href="protocol.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch current"><a href="protocol.header.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>header</span></div></a></li><li class="depth-2 branch"><a href="protocol.node.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node</span></div></a></li><li class="depth-2 branch"><a href="protocol.platform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>platform</span></div></a></li><li class="depth-2 branch"><a href="protocol.socket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>socket</span></div></a></li><li class="depth-2 branch"><a href="protocol.tlvs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tlvs</span></div></a></li><li class="depth-2"><a href="protocol.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="protocol.header.html#var-DEFAULT-BUF-SIZE"><div class="inner"><span>DEFAULT-BUF-SIZE</span></div></a></li><li class="depth-1"><a href="protocol.header.html#var-read-header"><div class="inner"><span>read-header</span></div></a></li><li class="depth-1"><a href="protocol.header.html#var-read-header-full"><div class="inner"><span>read-header-full</span></div></a></li><li class="depth-1"><a href="protocol.header.html#var-readers"><div class="inner"><span>readers</span></div></a></li><li class="depth-1"><a href="protocol.header.html#var-write-header"><div class="inner"><span>write-header</span></div></a></li><li class="depth-1"><a href="protocol.header.html#var-write-header-full"><div class="inner"><span>write-header-full</span></div></a></li><li class="depth-1"><a href="protocol.header.html#var-writers"><div class="inner"><span>writers</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">protocol.header</h1><div class="doc"><div class="markdown"><p>Read and write header data.</p>
<p>Reader functions take <code>[buf start ctx]</code> and return <code>[end value]</code> where <code>end</code> is the offset in <code>buf</code> after the read value(s).</p>
<p>Writer functions take <code>[buf msg-map start ctx]</code> and return <code>end</code> where <code>end</code> is the offset in <code>buf</code> after the written value(s).</p></div></div><div class="public anchor" id="var-DEFAULT-BUF-SIZE"><h3>DEFAULT-BUF-SIZE</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L15">view source</a></div></div><div class="public anchor" id="var-read-header"><h3>read-header</h3><div class="usage"><code>(read-header buf start {:keys [readers spec], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Reads/decodes <code>buf</code> starting at <code>start</code> based on <code>(:spec ctx)</code> using reader functions in <code>(:readers ctx)</code>.</p>
<h2><a href="#parameters-" name="parameters-"></a>Parameters:</h2>
<ul>
  <li><code>buf</code>: is the buffer to read from</li>
  <li><code>start</code>: start reading from buf at this offset</li>
  <li><code>ctx</code>: a map of additional parsing context:
    <ul>
      <li><code>readers</code>: map of types to reader functions
        <ul>
          <li>reader functions take [buf start end ctx]</li>
        </ul>
      </li>
      <li><code>spec</code>: sequence of [name, type, extra-ctx]</li>
      <li><code>name</code>: field key used in returned map.</li>
      <li><code>type</code>: type to lookup in readers map</li>
      <li><code>extra-ctx</code>: extra context merged into ctx before reading:
        <ul>
          <li><code>default</code>: ignored for reading</li>
          <li><code>length</code>: length of field and can be:
            <ul>
              <li>number: the number of bytes from the start of field (offset)</li>
              <li><code>:*</code>: the rest of the buffer</li>
              <li>field: the name of a previously read field that contains  number of bytes from start of the field (offset)</li>
            </ul>
          </li>
        </ul>
      </li>
      <li><code>msg-map</code>: map of values previously read</li>
    </ul>
  </li>
</ul></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L20">view source</a></div></div><div class="public anchor" id="var-read-header-full"><h3>read-header-full</h3><div class="usage"><code>(read-header-full buf start ctx)</code></div><div class="doc"><div class="markdown"><p>Like <a href="protocol.header.html#var-read-header">read-header</a> but returns only the read value.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L109">view source</a></div></div><div class="public anchor" id="var-readers"><h3>readers</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Header readers</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L125">view source</a></div></div><div class="public anchor" id="var-write-header"><h3>write-header</h3><div class="usage"><code>(write-header buf msg-map start {:keys [writers spec], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Writes/encodes data in <code>msg-map</code> into <code>buf</code> starting at <code>start</code> based on <code>(:spec ctx)</code> using writer functions in <code>(:writers ctx)</code>.</p>
<h2><a href="#parameters-" name="parameters-"></a>Parameters:</h2>
<ul>
  <li><code>buf</code>: is the buffer to write into (if nil then allocates  a buffer of <code>DEFAULT-BUF-SIZE</code> bytes)</li>
  <li><code>msg-map</code>: map of field names -&gt; field values to encode.</li>
  <li><code>start</code>: start writing at offset</li>
  <li><code>ctx</code>: a map of additional parsing context:
    <ul>
      <li><code>writers</code> is a map of types to writer functions</li>
      <li>writer functions that take [buf val start ctx]</li>
      <li><code>spec</code>: sequence of [name, type, lenth, default]
        <ul>
          <li><code>name</code>: field key to lookup in msg-map.</li>
          <li><code>type</code>: type to lookup in writers map</li>
          <li><code>extra-ctx</code>: extra context merged into ctx before writing
            <ul>
              <li><code>default</code>: if msg-map does not contain <code>name</code> then this is  used instead</li>
              <li><code>length</code>:
                <ul>
                  <li>number: the number of bytes from the start of field (offset)</li>
                  <li><code>:*</code>: the rest of the buffer</li>
                  <li>field: the name of a field in msg-map that contains  number of bytes from start of the field (offset)</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li><code>msg-map</code>: parent msg-map for compound writers</li>
    </ul>
  </li>
</ul></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L64">view source</a></div></div><div class="public anchor" id="var-write-header-full"><h3>write-header-full</h3><div class="usage"><code>(write-header-full buf msg-map start ctx)</code></div><div class="doc"><div class="markdown"><p>Like <a href="protocol.header.html#var-write-header">write-header</a> but allocates a default sized buffer if not provided and returns the encoded buffer sliced to size of the actual written data.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L114">view source</a></div></div><div class="public anchor" id="var-writers"><h3>writers</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Header writers</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/header.cljc#L128">view source</a></div></div></div></body></html>