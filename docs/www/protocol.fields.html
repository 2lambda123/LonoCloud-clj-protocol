<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>protocol.fields documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-protocol</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="tutorial.html"><div class="inner"><span>Quick Tutorial</span></div></a></li><li class="depth-1 "><a href="examples.html"><div class="inner"><span>Example programs</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dhcp</span></div></div></li><li class="depth-2 branch"><a href="dhcp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="dhcp.json-pool-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>json-pool-server</span></div></a></li><li class="depth-2 branch"><a href="dhcp.node-client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node-client</span></div></a></li><li class="depth-2 branch"><a href="dhcp.node-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node-server</span></div></a></li><li class="depth-2"><a href="dhcp.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>icmp</span></div></div></li><li class="depth-2 branch"><a href="icmp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="icmp.ping.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ping</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>pcap</span></div></div></li><li class="depth-2 branch"><a href="pcap.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="pcap.nbb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nbb</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>protocol</span></div></div></li><li class="depth-2 branch"><a href="protocol.addrs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>addrs</span></div></a></li><li class="depth-2 branch current"><a href="protocol.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch"><a href="protocol.header.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>header</span></div></a></li><li class="depth-2 branch"><a href="protocol.node.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node</span></div></a></li><li class="depth-2 branch"><a href="protocol.platform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>platform</span></div></a></li><li class="depth-2 branch"><a href="protocol.socket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>socket</span></div></a></li><li class="depth-2 branch"><a href="protocol.tlvs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tlvs</span></div></a></li><li class="depth-2"><a href="protocol.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="protocol.fields.html#var-int-.3Ehex"><div class="inner"><span>int-&gt;hex</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-int-.3Eoctet"><div class="inner"><span>int-&gt;octet</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-list-.3Elookup"><div class="inner"><span>list-&gt;lookup</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-octet-.3Eint"><div class="inner"><span>octet-&gt;int</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-read-bitfield"><div class="inner"><span>read-bitfield</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-read-choice"><div class="inner"><span>read-choice</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-read-lookup"><div class="inner"><span>read-lookup</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-read-loop"><div class="inner"><span>read-loop</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-read-repeat"><div class="inner"><span>read-repeat</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-readers-BE"><div class="inner"><span>readers-BE</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-readers-LE"><div class="inner"><span>readers-LE</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-write-bitfield"><div class="inner"><span>write-bitfield</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-write-choice"><div class="inner"><span>write-choice</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-write-lookup"><div class="inner"><span>write-lookup</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-write-loop"><div class="inner"><span>write-loop</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-write-repeat"><div class="inner"><span>write-repeat</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-writers-BE"><div class="inner"><span>writers-BE</span></div></a></li><li class="depth-1"><a href="protocol.fields.html#var-writers-LE"><div class="inner"><span>writers-LE</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">protocol.fields</h1><div class="doc"><div class="markdown"><p>Read, write, and manipulate field data.</p>
<p>Reader functions take <code>[buf start ctx]</code> and return <code>[end
value-or-values]</code> where <code>end</code> is the offset in <code>buf</code> after the read value(s).</p>
<p>Writer functions take <code>[buf value-or-values start ctx]</code> and return <code>end</code> where <code>end</code> is the offset in <code>buf</code> after the written value(s).</p></div></div><div class="public anchor" id="var-int-.3Ehex"><h3>int-&gt;hex</h3><div class="usage"><code>(int-&gt;hex i)</code></div><div class="doc"><div class="markdown"><p>Convert integer <code>i</code> into hex string representation</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L33">view source</a></div></div><div class="public anchor" id="var-int-.3Eoctet"><h3>int-&gt;octet</h3><div class="usage"><code>(int-&gt;octet n cnt)</code></div><div class="doc"><div class="markdown"><p>Convert integer <code>n</code> into <code>cnt</code> octets/bytes (in MSB first order)</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L25">view source</a></div></div><div class="public anchor" id="var-list-.3Elookup"><h3>list-&gt;lookup</h3><div class="usage"><code>(list-&gt;lookup coll &amp; idxs)</code></div><div class="doc"><div class="markdown"><p>Takes columnar collection and one or more [k-idx v-idx] pairs and returns a map contructed from key/value pairs selected from <code>k-idx</code>/<code>v-idx</code> columns of <code>coll</code>. If <code>v-idx</code> does not exist for a given row then the value defaults to nil.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L41">view source</a></div></div><div class="public anchor" id="var-octet-.3Eint"><h3>octet-&gt;int</h3><div class="usage"><code>(octet-&gt;int octets)</code></div><div class="doc"><div class="markdown"><p>Convert sequence of octets/bytes <code>octets</code> (in MSB first order) into an integer</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L19">view source</a></div></div><div class="public anchor" id="var-read-bitfield"><h3>read-bitfield</h3><div class="usage"><code>(read-bitfield buf start {:keys [length spec le?], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Read <code>length</code> bytes from <code>buf</code> starting at <code>start</code> and return a map of bitfields based on those bytes and the bitfield <code>spec</code>. The bitfield <code>spec</code> is a sequence <code>[name type bits]</code> entries where <code>name</code> is the bitfield key name, <code>type</code> can be either <code>:int</code> or <code>:bool</code> (for integer and boolean bitfield respectively), and <code>bits</code> is the number of bits to decode for that bitfield.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L188">view source</a></div></div><div class="public anchor" id="var-read-choice"><h3>read-choice</h3><div class="usage"><code>(read-choice buf start {:keys [msg-map readers choice-path choices], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Read using a reader and context that is selected based on a previously read value. The <code>choice-path</code> vector is looked up in <code>msg-map</code> (using <code>get-in</code>) to get a choice key. The choice key is looked up in <code>choices</code> to get a choice context map. The choice map must contain a <code>:choice-type</code> that specifies the selected reader. Any other entries in the choice context map are merged into the new context for that reader.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L146">view source</a></div></div><div class="public anchor" id="var-read-lookup"><h3>read-lookup</h3><div class="usage"><code>(read-lookup buf start {:keys [readers lookup-type lookup], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Read <code>lookup-type</code> type from <code>buf</code> at <code>start</code> and lookup that key in <code>lookup</code> to get the value to return</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L57">view source</a></div></div><div class="public anchor" id="var-read-loop"><h3>read-loop</h3><div class="usage"><code>(read-loop buf start {:keys [readers loop-type length], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Read a sequence of <code>loop-type</code> elements from <code>buf</code> starting at <code>start</code>. Elements will be read until either length is reached, the end of the buffer is reached, or the <code>loop-type</code> reader returns a three-tuple <code>[end value stop?]</code> with a truthy <code>stop?</code> value.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L104">view source</a></div></div><div class="public anchor" id="var-read-repeat"><h3>read-repeat</h3><div class="usage"><code>(read-repeat buf start {:keys [readers length repeat-type repeat-size], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Read a sequence of <code>repeat-type</code> elements from <code>buf</code> starting at <code>start</code>. The number of elements read is <code>length</code> / <code>repeat-size</code></p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L80">view source</a></div></div><div class="public anchor" id="var-readers-BE"><h3>readers-BE</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Field readers (big endian)</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L253">view source</a></div></div><div class="public anchor" id="var-readers-LE"><h3>readers-LE</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Field readers (little endian)</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L261">view source</a></div></div><div class="public anchor" id="var-write-bitfield"><h3>write-bitfield</h3><div class="usage"><code>(write-bitfield buf bf-map start {:keys [spec le?], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Write the bitfield values from <code>bf-map</code> into <code>buf</code> starting at <code>start</code> and based on the bitfield <code>spec</code>. The bitfield <code>spec</code> is a sequence <code>[name type bits]</code> entries where <code>name</code> is the bitfield key in <code>bf-map</code>, <code>type</code> can be either <code>:int</code> or <code>:bool</code> (for integer and boolean bitfield respectively), and <code>bits</code> is the number of bits to encode for that bitfield.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L214">view source</a></div></div><div class="public anchor" id="var-write-choice"><h3>write-choice</h3><div class="usage"><code>(write-choice buf value start {:keys [msg-map writers choice-path choices], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Write using a writer and context that is selected based on another value in <code>msg-map</code>. The <code>choice-path</code> vector is looked up in <code>msg-map</code> (using <code>get-in</code>) to get a choice key. The choice key is looked up in <code>choices</code> to get a choice context map. The choice map must contain a <code>:choice-type</code> that specifies the selected writer. Any other entries in the choice context map are merged into the new context for that writer.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L166">view source</a></div></div><div class="public anchor" id="var-write-lookup"><h3>write-lookup</h3><div class="usage"><code>(write-lookup buf k start {:keys [writers lookup-type lookup], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Lookup <code>k</code> in <code>lookup</code> and write it as a <code>lookup-type</code> type into <code>buf</code> at <code>start</code></p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L68">view source</a></div></div><div class="public anchor" id="var-write-loop"><h3>write-loop</h3><div class="usage"><code>(write-loop buf values start {:keys [writers loop-type], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Write a sequence of <code>loop-type</code> elements into <code>buf</code> starting at <code>start</code>. All elements in <code>values</code> will be written to the buffer.</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L128">view source</a></div></div><div class="public anchor" id="var-write-repeat"><h3>write-repeat</h3><div class="usage"><code>(write-repeat buf values start {:keys [writers repeat-type repeat-size], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Write a sequence of <code>repeat-type</code> elements (of size <code>repeat-size</code>) into <code>buf</code> starting at <code>start</code></p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L92">view source</a></div></div><div class="public anchor" id="var-writers-BE"><h3>writers-BE</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Field writers (big endian)</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L282">view source</a></div></div><div class="public anchor" id="var-writers-LE"><h3>writers-LE</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Field writers (little endian)</p></div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/df12407d94a03acd774cec8bab759059c35dab5f/src/protocol/fields.cljc#L290">view source</a></div></div></div></body></html>