<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>protocol.tlvs documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-protocol</span> <span class="project-version">1.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="tutorial.html"><div class="inner"><span>Quick Tutorial</span></div></a></li><li class="depth-1 "><a href="examples.html"><div class="inner"><span>Example programs</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dhcp</span></div></div></li><li class="depth-2 branch"><a href="dhcp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="dhcp.json-pool-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>json-pool-server</span></div></a></li><li class="depth-2 branch"><a href="dhcp.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-2 branch"><a href="dhcp.mac2ip-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mac2ip-server</span></div></a></li><li class="depth-2 branch"><a href="dhcp.node-client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node-client</span></div></a></li><li class="depth-2 branch"><a href="dhcp.node-server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node-server</span></div></a></li><li class="depth-2 branch"><a href="dhcp.simple-client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>simple-client</span></div></a></li><li class="depth-2"><a href="dhcp.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>icmp</span></div></div></li><li class="depth-2 branch"><a href="icmp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="icmp.ping.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ping</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>pcap</span></div></div></li><li class="depth-2"><a href="pcap.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>protocol</span></div></div></li><li class="depth-2 branch"><a href="protocol.addrs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>addrs</span></div></a></li><li class="depth-2 branch"><a href="protocol.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch"><a href="protocol.header.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>header</span></div></a></li><li class="depth-2 branch"><a href="protocol.platform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>platform</span></div></a></li><li class="depth-2 branch"><a href="protocol.socket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>socket</span></div></a></li><li class="depth-2 branch current"><a href="protocol.tlvs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tlvs</span></div></a></li><li class="depth-2"><a href="protocol.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="protocol.tlvs.html#var-assoc-in-tlv"><div class="inner"><span>assoc-in-tlv</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-assoc-in-tlv*"><div class="inner"><span>assoc-in-tlv*</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-get-in-tlv"><div class="inner"><span>get-in-tlv</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-get-in-tlv*"><div class="inner"><span>get-in-tlv*</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-read-tlv"><div class="inner"><span>read-tlv</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-read-tlv-map"><div class="inner"><span>read-tlv-map</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-read-tlv-seq"><div class="inner"><span>read-tlv-seq</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-readers"><div class="inner"><span>readers</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-tlv-list-.3Elookup"><div class="inner"><span>tlv-list-&gt;lookup</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-update-in-tlv"><div class="inner"><span>update-in-tlv</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-update-in-tlv*"><div class="inner"><span>update-in-tlv*</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-write-tlv"><div class="inner"><span>write-tlv</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-write-tlv-map"><div class="inner"><span>write-tlv-map</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-write-tlv-seq"><div class="inner"><span>write-tlv-seq</span></div></a></li><li class="depth-1"><a href="protocol.tlvs.html#var-writers"><div class="inner"><span>writers</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">protocol.tlvs</h1><div class="doc"><div class="markdown"><p>Read, write, and manipulate TLV (type-length-value) data.</p>
<p>Reader functions take <code>[buf start ctx]</code> and return <code>[end value]</code> where <code>end</code> is the offset in <code>buf</code> after the read value(s).</p>
<p>Writer functions take <code>[buf tlv-or-tlvs start ctx]</code> and return <code>end</code> where <code>end</code> is the offset in <code>buf</code> after the written value(s).</p>
<p><a href="https://en.wikipedia.org/wiki/Type%E2%80%93length%E2%80%93value">https://en.wikipedia.org/wiki/Type%E2%80%93length%E2%80%93value</a></p>
</div></div><div class="public anchor" id="var-assoc-in-tlv"><h3>assoc-in-tlv</h3><div class="usage"><code>(assoc-in-tlv msg-map path value)</code></div><div class="doc"><div class="markdown"><p>Version of <a href="protocol.tlvs.html#var-assoc-in-tlv*">assoc-in-tlv*</a> that takes a <code>msg-map</code> containing a <code>:tlvs</code> key where the TLV sequence will be updated.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L181">view source</a></div></div><div class="public anchor" id="var-assoc-in-tlv*"><h3>assoc-in-tlv*</h3><div class="usage"><code>(assoc-in-tlv* tlvs path value)</code></div><div class="doc"><div class="markdown"><p>Replaces TLV values in the <code>tlvs</code> at <code>path</code>. <code>tlvs</code> is a TLV hierarchy/sequence and <code>path</code> is a sequence of TLV type names to use in traversing the hierachy. Any matching TLV values will be replaced with <code>value</code>.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L167">view source</a></div></div><div class="public anchor" id="var-get-in-tlv"><h3>get-in-tlv</h3><div class="usage"><code>(get-in-tlv msg-map path)</code></div><div class="doc"><div class="markdown"><p>Version of <a href="protocol.tlvs.html#var-get-in-tlv*">get-in-tlv*</a> that takes a <code>msg-map</code> containing a <code>:tlvs</code> key where the TLV sequence will searched.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L187">view source</a></div></div><div class="public anchor" id="var-get-in-tlv*"><h3>get-in-tlv*</h3><div class="usage"><code>(get-in-tlv* tlvs path)</code></div><div class="doc"><div class="markdown"><p>Takes a <code>tlvs</code> TLV hierachy/sequence and a <code>path</code> which is sequence of TLV type names to use in traversing the hierarchy. The return value is a sequence of matching TLV values and may be multiple if multiple TLVs of the same type are found at the leaf location.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L140">view source</a></div></div><div class="public anchor" id="var-read-tlv"><h3>read-tlv</h3><div class="usage"><code>(read-tlv buf start {:keys [readers path lookup tlv-tsize tlv-lsize], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Read a TLV (type-length-value) field from <code>buf</code> starting at <code>start</code>. The byte sizes of the type and length parts are specified by <code>tlv-tsize</code> and <code>tlv-lsize</code> respectively. The type value is used to lookup the reader and context from the <code>lookup</code> map (which should be constructed using <a href="protocol.tlvs.html#var-tlv-list-.3Elookup">tlv-list-&gt;lookup</a>) which will be used to read the TLV value part.</p>
<p>The returned value will be <code>[tlv-name tlv-value]</code> where <code>tlv-name</code> is the looked up type code and <code>tlv-value</code> is the value read from the field. If the looked up type is <code>:tlv-stop</code> then a true value will be appended to the returned tuple to indicate to looping readers that there are no more TLVs to read.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L38">view source</a></div></div><div class="public anchor" id="var-read-tlv-map"><h3>read-tlv-map</h3><div class="usage"><code>(read-tlv-map buf start ctx)</code></div><div class="doc"><div class="markdown"><p>Same as <a href="protocol.tlvs.html#var-read-tlv-seq">read-tlv-seq</a> but returns a map of TLV names to values</p>
<p>Note: repeats of the same TLV code/name will overwrite earlier values.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L112">view source</a></div></div><div class="public anchor" id="var-read-tlv-seq"><h3>read-tlv-seq</h3><div class="usage"><code>(read-tlv-seq buf start {:keys [length], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Use <a href="protocol.fields.html#var-read-loop">fields/read-loop</a> to read multiple TLVs from <code>buf</code> starting at <code>start</code> and ending when a stop value is read or length is reached.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L105">view source</a></div></div><div class="public anchor" id="var-readers"><h3>readers</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>TLV readers</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L195">view source</a></div></div><div class="public anchor" id="var-tlv-list-.3Elookup"><h3>tlv-list-&gt;lookup</h3><div class="usage"><code>(tlv-list-&gt;lookup tlist)</code></div><div class="doc"><div class="markdown"><p>Takes a sequence of <code>[code, name, internal type, extra-context]</code> and converts it into a TLV lookup map containing:</p>
<ul>
<li><code>:list</code>  - original list/sequence</li>
<li><code>:types</code> - map of codes and names to types</li>
<li><code>:ctxs</code>  - map of codes and names to contexts</li>
<li><code>:names</code> - map of names to codes</li>
<li><code>:codes</code> - map of codes to names</li>
</ul>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L18">view source</a></div></div><div class="public anchor" id="var-update-in-tlv"><h3>update-in-tlv</h3><div class="usage"><code>(update-in-tlv msg-map &amp; args)</code></div><div class="doc"><div class="markdown"><p>Version of <a href="protocol.tlvs.html#var-update-in-tlv*">update-in-tlv*</a> that takes a <code>msg-map</code> containing a <code>:tlvs</code> key where the TLV sequence will be updated.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L175">view source</a></div></div><div class="public anchor" id="var-update-in-tlv*"><h3>update-in-tlv*</h3><div class="usage"><code>(update-in-tlv* tlvs path f &amp; args)</code></div><div class="doc"><div class="markdown"><p>Update TLV values in the <code>tlvs</code> at <code>path</code>. <code>tlvs</code> is a TLV hierarchy/sequence and <code>path</code> is a sequence of TLV type names to use in traversing the hierachy. Any matching TLV values will be updated using <code>(apply f tlv-value args)</code>.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L152">view source</a></div></div><div class="public anchor" id="var-write-tlv"><h3>write-tlv</h3><div class="usage"><code>(write-tlv buf [tlv-name tlv-value] start {:keys [writers path lookup tlv-tsize tlv-lsize], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Write a TLV (type-length-value) field into <code>buf</code> starting at <code>start</code>. The byte sizes of the type and length parts are specified by <code>tlv-tsize</code> and <code>tlv-lsize</code> respectively. The <code>type-name</code> is used to lookup the type code and also the writer and context from the <code>lookup</code> map (which should be constructed using <a href="protocol.tlvs.html#var-tlv-list-.3Elookup">tlv-list-&gt;lookup</a>) which will be used to write the TLV value part.</p>
<p>If the type of the TLV is <code>:tlv-stop</code> then only the type part of the TLV will be written with the stop code (no length or value part will be written).</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L70">view source</a></div></div><div class="public anchor" id="var-write-tlv-map"><h3>write-tlv-map</h3><div class="usage"><code>(write-tlv-map buf tlv-map tlv-start {:keys [lookup], :as ctx})</code></div><div class="doc"><div class="markdown"><p>Same as <a href="protocol.tlvs.html#var-write-tlv-seq">write-tlv-seq</a> but takes a TLV map (<code>tlv-map</code>) rather than a a sequence of TLVs. Uses <code>(:list lookup)</code> to determine the order to write TLVs from <code>tlv-map</code>.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L127">view source</a></div></div><div class="public anchor" id="var-write-tlv-seq"><h3>write-tlv-seq</h3><div class="usage"><code>(write-tlv-seq buf tlvs start ctx)</code></div><div class="doc"><div class="markdown"><p>Use <a href="protocol.fields.html#var-write-loop">fields/write-loop</a> to write multiple TLVs (<code>tlvs</code>) into <code>buf</code> starting at <code>start</code>.</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L121">view source</a></div></div><div class="public anchor" id="var-writers"><h3>writers</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>TLV writers</p>
</div></div><div class="src-link"><a href="http://github.com/LonoCloud/clj-protocol/blob/2c65eff984aa0563125aa4db1e430c874851dbcf/src/protocol/tlvs.cljc#L201">view source</a></div></div></div></body></html>